Необходимо написать приложение на Java с использованием для обработки файлов в исходном json формате с использованием Apache Spark. Приложение должно поддерживать два режима:


* Выборка событий app_loaded (загрузка приложения) и registered (регистрация в приложении),  а также сохранение этих данных в директории на диске в формате parquet (например, /home/user/events/app_loaded/*.parquet и /home/user/events/registered/*.parquet). Типы значений атрибутов должны соответствовать целевым, согласно спецификации событий.

* Анализ уже обработанных событий app_loaded и registered. Необходимо рассчитать процентное соотношение пользователей, которые в течение календарной недели, следующей после регистрации, выполняли загрузку приложения к общему количеству зарегистрированных пользователей. Результат расчета должен выводится в консоль.

В исходном файле содержатся записи событий и свойств в формате json.
Типы записей в исходном json:

    Event (“_t” - время (формат unix timestamp), “_n” - событие, “_p” - email пользователя, “attr_name" - значение атрибута attr_name)

Спецификация событий
Регистрация пользователя:


"registered": {
  "time": "timestamp"
  "email": "string",
  "channel": "string"
}
Загрузка приложения:
"app_loaded": {
"time": "timestamp"
"email": "string",
"device_type": "string"
}
